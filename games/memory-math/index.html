<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Math Memory</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800;900&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Nunito', sans-serif; background: linear-gradient(135deg, #2d1b69, #11998e); color: white; min-height: 100vh; display: flex; flex-direction: column; align-items: center; }
    .screen { width: 100vw; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 1.5rem; padding: 2rem; }
    .hidden { display: none !important; }
    h1 { font-size: 2.5rem; font-weight: 900; }
    h2 { font-size: 1.1rem; opacity: 0.7; }
    .big-btn { padding: 1rem 3rem; font-size: 1.3rem; font-weight: 900; border: none; border-radius: 50px; cursor: pointer; font-family: 'Nunito'; background: linear-gradient(135deg, #11998e, #38ef7d); color: white; }
    .big-btn:active { transform: scale(0.95); }
    
    .hud { display: flex; gap: 2rem; padding: 1rem; }
    .hud-item { text-align: center; }
    .hud-lbl { font-size: 0.7rem; opacity: 0.6; }
    .hud-val { font-size: 1.3rem; font-weight: 900; }
    
    .grid {
      display: grid; gap: 0.5rem; padding: 0.5rem;
      width: 100%; max-width: 400px;
    }
    .grid.size-4 { grid-template-columns: repeat(4, 1fr); }
    .grid.size-5 { grid-template-columns: repeat(5, 1fr); }
    
    .card {
      aspect-ratio: 1; display: flex; align-items: center; justify-content: center;
      border-radius: 12px; cursor: pointer; font-weight: 800; font-family: 'Nunito';
      font-size: 1.1rem; transition: all 0.3s; perspective: 1000px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    .card.flipped, .card.matched {
      background: white; color: #333;
    }
    .card.matched { background: #c8e6c9; color: #2e7d32; box-shadow: 0 0 15px rgba(76,175,80,0.3); }
    .card:not(.flipped):not(.matched):hover { transform: scale(1.05); }
    .card:not(.flipped):not(.matched)::after { content: '?'; font-size: 1.5rem; color: rgba(255,255,255,0.5); }
    .card.flipped::after, .card.matched::after { content: none; }
    
    .stats { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; max-width: 300px; width: 100%; }
    .stat { background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 12px; text-align: center; }
    .stat-val { font-size: 2rem; font-weight: 900; }
    .stat-lbl { font-size: 0.8rem; opacity: 0.7; }
    a.back { color: rgba(255,255,255,0.6); text-decoration: none; font-size: 0.9rem; }
  </style>
</head>
<body>
  <div id="start" class="screen">
    <h1>üß† MATH MEMORY</h1>
    <h2>Match equations with their answers!</h2>
    <div style="display:flex;flex-direction:column;gap:0.8rem;max-width:280px;width:100%">
      <label style="font-weight:700;font-size:0.9rem">Grid Size:
        <select id="size" style="width:100%;padding:0.5rem;border-radius:8px;border:none;font-size:1rem;font-family:Nunito;margin-top:0.3rem">
          <option value="4" selected>4√ó4 (8 pairs)</option>
          <option value="5">4√ó5 (10 pairs)</option>
        </select>
      </label>
    </div>
    <button class="big-btn" onclick="startGame()">PLAY!</button>
    <a href="../" class="back">‚Üê Back to Games</a>
  </div>
  
  <div id="game" class="screen hidden">
    <div class="hud">
      <div class="hud-item"><div class="hud-lbl">MOVES</div><div class="hud-val" id="moves">0</div></div>
      <div class="hud-item"><div class="hud-lbl">PAIRS</div><div class="hud-val" id="pairs">0/8</div></div>
      <div class="hud-item"><div class="hud-lbl">TIME</div><div class="hud-val" id="timer">0:00</div></div>
    </div>
    <div class="grid" id="grid"></div>
  </div>
  
  <div id="result" class="screen hidden">
    <h1>üéâ Complete!</h1>
    <div class="stats">
      <div class="stat"><div class="stat-val" id="r-moves">0</div><div class="stat-lbl">Moves</div></div>
      <div class="stat"><div class="stat-val" id="r-time">0:00</div><div class="stat-lbl">Time</div></div>
    </div>
    <div id="r-stars" style="font-size:3rem;margin:1rem 0">‚≠ê‚≠ê‚≠ê</div>
    <button class="big-btn" onclick="location.reload()">PLAY AGAIN</button>
    <a href="../" class="back">‚Üê Back to Games</a>
  </div>

  <script>
    let s = {};
    
    function genPairs(count) {
      const pairs = [];
      const used = new Set();
      while (pairs.length < count) {
        const a = Math.floor(Math.random() * 12) + 1;
        const b = Math.floor(Math.random() * 12) + 1;
        const ops = ['+', '‚àí', '√ó'];
        const op = ops[Math.floor(Math.random() * ops.length)];
        let ans;
        if (op === '+') ans = a + b;
        else if (op === '‚àí') { if (a < b) continue; ans = a - b; }
        else ans = a * b;
        
        const eq = `${a} ${op} ${b}`;
        const key = eq + '=' + ans;
        if (used.has(key)) continue;
        used.add(key);
        pairs.push({ equation: eq, answer: String(ans), id: pairs.length });
      }
      return pairs;
    }
    
    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }
    
    function startGame() {
      const size = parseInt(document.getElementById('size').value);
      const pairCount = size === 4 ? 8 : 10;
      const pairs = genPairs(pairCount);
      
      // Create cards: each pair has equation card + answer card
      const cards = [];
      pairs.forEach(p => {
        cards.push({ text: p.equation, pairId: p.id, type: 'eq' });
        cards.push({ text: p.answer, pairId: p.id, type: 'ans' });
      });
      shuffle(cards);
      
      s = { cards, moves: 0, matched: 0, total: pairCount, flipped: [], locked: false, startTime: Date.now(), timerInterval: null };
      
      document.getElementById('start').classList.add('hidden');
      document.getElementById('game').classList.remove('hidden');
      
      const grid = document.getElementById('grid');
      grid.className = `grid size-${size}`;
      grid.innerHTML = '';
      
      cards.forEach((card, i) => {
        const div = document.createElement('div');
        div.className = 'card';
        div.dataset.index = i;
        div.addEventListener('click', () => flipCard(div, i));
        grid.appendChild(div);
      });
      
      updateHUD();
      s.timerInterval = setInterval(updateTimer, 1000);
    }
    
    function flipCard(el, idx) {
      if (s.locked || el.classList.contains('flipped') || el.classList.contains('matched')) return;
      
      el.classList.add('flipped');
      el.textContent = s.cards[idx].text;
      s.flipped.push({ el, idx });
      
      if (s.flipped.length === 2) {
        s.moves++;
        s.locked = true;
        const [a, b] = s.flipped;
        
        if (a.idx !== b.idx && s.cards[a.idx].pairId === s.cards[b.idx].pairId) {
          // Match!
          a.el.classList.add('matched');
          b.el.classList.add('matched');
          s.matched++;
          s.flipped = [];
          s.locked = false;
          updateHUD();
          if (s.matched === s.total) endGame();
        } else {
          setTimeout(() => {
            a.el.classList.remove('flipped');
            a.el.textContent = '';
            b.el.classList.remove('flipped');
            b.el.textContent = '';
            s.flipped = [];
            s.locked = false;
          }, 800);
        }
        updateHUD();
      }
    }
    
    function updateHUD() {
      document.getElementById('moves').textContent = s.moves;
      document.getElementById('pairs').textContent = `${s.matched}/${s.total}`;
    }
    
    function updateTimer() {
      const elapsed = Math.floor((Date.now() - s.startTime) / 1000);
      const min = Math.floor(elapsed / 60);
      const sec = elapsed % 60;
      document.getElementById('timer').textContent = `${min}:${String(sec).padStart(2, '0')}`;
    }
    
    function endGame() {
      clearInterval(s.timerInterval);
      const elapsed = Math.floor((Date.now() - s.startTime) / 1000);
      const min = Math.floor(elapsed / 60);
      const sec = elapsed % 60;
      
      setTimeout(() => {
        document.getElementById('game').classList.add('hidden');
        document.getElementById('result').classList.remove('hidden');
        document.getElementById('r-moves').textContent = s.moves;
        document.getElementById('r-time').textContent = `${min}:${String(sec).padStart(2, '0')}`;
        
        const efficiency = s.total / s.moves;
        const stars = efficiency >= 0.8 ? '‚≠ê‚≠ê‚≠ê' : efficiency >= 0.5 ? '‚≠ê‚≠ê' : '‚≠ê';
        document.getElementById('r-stars').textContent = stars;
      }, 500);
    }
  </script>
</body>
</html>
